<!DOCTYPE html>
<html>
<head>
    <title>Protocol Portal | Phase 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #0052ff; --danger: #ff4d4d; --success: #00fb5a; --bg: #050505; }
        body { background-color: var(--bg); color: #fff; font-family: 'Inter', sans-serif; text-align: center; margin: 0; padding: 20px; }
        .container { max-width: 650px; margin: 40px auto; }
        
        h1 { font-weight: 700; color: var(--primary); letter-spacing: -1px; }
        .warning-box { background: rgba(255, 171, 0, 0.1); border: 1px solid #ffab00; padding: 20px; border-radius: 12px; margin-bottom: 30px; text-align: left; font-size: 0.95rem; }
        .warning-box strong { color: #ffab00; display: block; margin-bottom: 5px; text-transform: uppercase; font-size: 0.75rem; letter-spacing: 1px; }
        
        video, .image-container { width: 100%; max-width: 600px; border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); background: #111; }
        .image-container { position: relative; height: 350px; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .image-container img { width: 100%; height: 100%; object-fit: cover; opacity: 0.3; filter: grayscale(100%); }
        .question-overlay { position: absolute; padding: 30px; font-size: 1.2rem; font-weight: 400; color: var(--success); text-shadow: 0 2px 10px rgba(0,0,0,0.8); }
        
        #timer { font-size: 32px; font-weight: 700; color: var(--danger); margin-bottom: 20px; }
        input, textarea { width: 100%; max-width: 580px; padding: 16px; border-radius: 8px; margin-bottom: 20px; background: #111; color: #fff; border: 1px solid #333; font-family: inherit; font-size: 1rem; }
        button { background: var(--primary); color: #fff; padding: 16px 40px; border: none; border-radius: 8px; cursor: pointer; font-weight: 700; font-size: 1rem; }
    </style>
</head>
<body>
    <div class="container" id="box">
        <h1>Phase 2: Protocol Entry</h1>
        <div class="warning-box">
            <strong>Security Protocol</strong>
            - 60 seconds per response.<br>
            - <strong>Single-Entry Only:</strong> Your email is recorded upon initialization.<br>
            - <strong>Breach Detection:</strong> Switching tabs or minimizing terminates the session and voids the email.
        </div>
        <input type="email" id="userEmail" placeholder="Enter Application Email" required><br>
        <button onclick="start()">Initialize Interview</button>
    </div>

    <script>
        const FORMSPREE_URL = "https://formspree.io/f/xojnqbba"; 

        let step = 0; let time = 60; let clock; 
        let data = { email: "" };

        const questions = [
            "", "", "", // 0, 1, 2 are placeholders/videos
            "A user comes to you crying because they lost their seed phrase and they want you to 'reset' their account. How do you explain the reality of self-custody to them without being a jerk?",
            "When you see a new token launch on Base, what is the #1 technical 'red flag' you check for on-chain to make sure it isn't a Honey Pot or a scam?",
            "We are building a high-signal inner circle. What is the one unique skill or perspective you bring that we can't find in anyone else?",
            "Explain the difference between 'Mainnet' and 'Testnet'. Why is it dangerous to skip testing on Base Sepolia before going live?",
            "If protocol TVL drops 50% in one hour but the code is secure, what is your message to the community?",
            "What is 'Slippage'? If a user sets it to 20% on a high-liquidity pair, are they protecting or hurting themselves?",
            "This protocol requires 100% conviction. If accepted, what is your primary contribution to the ecosystem over the next 12 months?"
        ];

        window.onblur = () => { 
            if(step > 0 && step <= 10) {
                clearInterval(clock);
                localStorage.setItem('done_' + data.email, 'true');
                document.getElementById('box').innerHTML = "<h1 style='color:var(--danger)'>BREACH DETECTED</h1><p>Tab switching is prohibited. This email has been voided.</p>";
            }
        }; 

        function start() { 
            data.email = document.getElementById('userEmail').value.toLowerCase().trim();
            if(!data.email.includes('@')) { alert("Valid email required"); return; }
            if(localStorage.getItem('done_' + data.email)) {
                alert("Access Denied: This email has already attempted entry."); return;
            }
            step = 1; render(); clock = setInterval(tick, 1000); 
        }

        function tick() { 
            time--; document.getElementById('timer').innerText = time + "s"; 
            if(time <= 0) next(); 
        }

        async function next() { 
            data['ans' + step] = document.getElementById('ans').value;
            if(step < 10) { 
                step++; time = 60; render(); 
            } else { 
                clearInterval(clock);
                document.getElementById('box').innerHTML = "<h1>Transmitting Data...</h1>";
                await fetch(FORMSPREE_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data) });
                localStorage.setItem('done_' + data.email, 'true'); 
                document.getElementById('box').innerHTML = "<h1 style='color:var(--success)'>Entry Successful</h1><p>Transmission complete.</p>"; 
            }
        }

        function render() {
            let media = (step <= 2) 
                ? `<video autoplay playsinline muted src="video${step}.MP4" onloadedmetadata="this.muted=false; this.play();"></video>`
                : `<div class="image-container"><img src="avatar.jpg"><div class="question-overlay">${questions[step]}</div></div>`;

            document.getElementById('box').innerHTML = `
                <div id="timer">${time}s</div>
                ${media}
                <br>
                <textarea id="ans" placeholder="Type response..." autofocus></textarea>
                <br>
                <button onclick="next()">Submit Response</button>
            `;
        }
    </script>
</body>
</html>
